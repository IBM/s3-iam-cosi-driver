# Example of the most permissive access policy.
kind: BucketAccessClass
apiVersion: objectstorage.k8s.io/v1alpha1
metadata:
  name: account1-permissive
driverName: s3-iam.objectstorage.k8s.io
authenticationType: KEY
parameters:
  accountSecret: s3-account1
  accountSecretNamespace: s3-iam-cosi-driver
  iamUserPattern: "cosi-${bucketAccessName}-${random}"

  # Users are granted all actions on buckets (by default or by request)
  defaultPolicy:
    allow:
      actions:
        - "s3:*"
  requestPolicy:
    allow:
      actions:
      - "s3:*"

  # No other actions are denied
---
# By default, this request is granted all S3 actions.
kind: BucketAccess
apiVersion: objectstorage.k8s.io/v1alpha1
metadata:
  name: my-bucket1-access
  namespace: default
spec:
  bucketClaimName: my-bucket1
  bucketAccessClassName: account1-permissive
  credentialsSecretName: my-bucket1-credentials
  protocol: s3
---
# This request will be granted all S3 actions.  User does not need to set any
# actions in accessRequest, neverthless if sent it will be granted.
kind: BucketAccess
apiVersion: objectstorage.k8s.io/v1alpha1
metadata:
  name: my-bucket1-access
  namespace: default
spec:
  bucketClaimName: my-bucket1
  bucketAccessClassName: account1-permissive
  credentialsSecretName: my-bucket1-credentials
  protocol: s3
  accessRequest:
    actions:
      - "s3:GetObject"
      - "s3:ListBucket"
      - "s3:PutObject"
